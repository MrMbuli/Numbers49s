<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>49s Lucky Pick</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#ffcc00"/>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 1rem;
      background: #111;
      color: #eee;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    h1 {
      margin-bottom: 0.5rem;
      color: #ffcc00;
    }
    .number-set {
      font-size: 1.2rem;
      margin: 0.5rem 0;
      padding: 0.5rem;
      background: #222;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .top-pick {
      background: #333;
      font-size: 1.5rem;
      border: 2px solid #ffcc00;
      margin-bottom: 1rem;
      font-weight: bold;
    }
    .bonus {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: #00ffff;
      color: #111;
      font-weight: bold;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      margin-left: 1rem;
      font-size: 1.1rem;
      user-select: none;
      box-shadow: 0 0 6px #00ffffaa;
    }
    button {
      background: #ffcc00;
      border: none;
      padding: 0.8rem 2rem;
      font-size: 1.1rem;
      border-radius: 6px;
      cursor: pointer;
      color: #222;
      user-select: none;
      margin: 0.5rem;
    }
    button:hover {
      background: #e6b800;
    }
    .disabled {
      opacity: 0.5;
      pointer-events: none;
    }
    #timer {
      margin: 1rem 0;
      color: #aaa;
    }
    #cooldownTimer {
      margin-top: 2rem;
      font-size: 1.2rem;
      color: #ffcc00;
      font-weight: bold;
      user-select: none;
    }
    footer {
      margin-top: auto;
      font-size: 0.8rem;
      color: #666;
      padding: 1rem 0 0;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>49s Lucky Pick</h1>
  <div id="numbers"></div>
  <div id="timer"></div>
  <button id="generateBtn">Generate 5 Sequences</button>
  <button id="membershipBtn">Join Full Membership (R10/month)</button>
  <a href="history.html"><button>📜 View History</button></a>
  <div id="cooldownTimer"></div>

  <footer>© 2025 49s Lucky Pick<br>Offline | 6x Picks | Bonus Number</footer>

  <script>
    const numbersDiv = document.getElementById('numbers');
    const generateBtn = document.getElementById('generateBtn');
    const membershipBtn = document.getElementById('membershipBtn');
    const timerDiv = document.getElementById('timer');
    const cooldownTimer = document.getElementById('cooldownTimer');

    const TEN_HOURS = 10 * 60 * 60 * 1000;

    function generateSet() {
      let main = new Set();
      while (main.size < 6) main.add(Math.floor(Math.random() * 49) + 1);
      let bonus;
      do {
        bonus = Math.floor(Math.random() * 49) + 1;
      } while (main.has(bonus));
      return { main: Array.from(main).sort((a,b) => a-b), bonus };
    }

    function generateAllSets() {
      let all = [];
      for (let i = 0; i < 5; i++) {
        all.push(generateSet());
      }
      return all;
    }

    function displaySets(sets) {
      numbersDiv.innerHTML = "";

      const first = sets[0];
      const topSet = document.createElement('div');
      topSet.className = 'number-set top-pick';
      topSet.innerHTML = `Top Pick: ${first.main.map(n => n.toString().padStart(2,'0')).join(' ')} <span class="bonus">${first.bonus.toString().padStart(2,'0')}</span>`;
      numbersDiv.appendChild(topSet);

      for (let i = 1; i < sets.length; i++) {
        const set = sets[i];
        const div = document.createElement('div');
        div.className = 'number-set';
        div.innerHTML = `Set ${i + 1}: ${set.main.map(n => n.toString().padStart(2,'0')).join(' ')} <span class="bonus">${set.bonus.toString().padStart(2,'0')}</span>`;
        numbersDiv.appendChild(div);
      }
    }

    function addToHistory(sets) {
      const date = new Date().toLocaleString();
      const entry = `(${date}) ` + sets.map(s => s.main.map(n=>n.toString().padStart(2,'0')).join(' ') + ` [${s.bonus.toString().padStart(2,'0')}]`).join(' | ');
      let history = JSON.parse(localStorage.getItem('history') || '[]');
      history.unshift(entry);
      if (history.length > 20) history = history.slice(0, 20);
      localStorage.setItem('history', JSON.stringify(history));
    }

    function updateStatus() {
      const isMember = localStorage.getItem('isMember') === 'true';
      const lastGen = parseInt(localStorage.getItem('lastGenerated') || '0');
      const now = Date.now();

      if (isMember) {
        generateBtn.classList.remove('disabled');
        timerDiv.textContent = "Full Member Access: Unlimited sets.";
        cooldownTimer.textContent = "";
      } else {
        const remaining = TEN_HOURS - (now - lastGen);
        if (remaining > 0) {
          generateBtn.classList.add('disabled');
          const hrs = Math.floor(remaining / (1000 * 60 * 60));
          const mins = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
          const secs = Math.floor((remaining % (1000 * 60)) / 1000);
          timerDiv.textContent = `Next free batch in: ${hrs}h ${mins}m ${secs}s`;
          cooldownTimer.textContent = `⏳ Please wait ${hrs}h ${mins}m ${secs}s before generating new numbers.`;
          setTimeout(updateStatus, 1000);
        } else {
          generateBtn.classList.remove('disabled');
          timerDiv.textContent = "Free Batch Available!";
          cooldownTimer.textContent = "";
        }
      }
    }

    generateBtn.addEventListener('click', () => {
      if (generateBtn.classList.contains('disabled')) return;
      const sets = generateAllSets();
      displaySets(sets);
      addToHistory(sets);
      if (localStorage.getItem('isMember') !== 'true') {
        localStorage.setItem('lastGenerated', Date.now().toString());
      }
      updateStatus();
    });

    membershipBtn.addEventListener('click', () => {
      const confirmJoin = confirm("Join Full Membership for R10/month?\n(This is just a simulation in offline mode)");
      if (confirmJoin) {
        localStorage.setItem('isMember', 'true');
        updateStatus();
        alert("You are now a Full Member! Unlimited sets unlocked.");
      }
    });

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js');
      });
    }

    updateStatus();
  </script>
</body>
</html>
