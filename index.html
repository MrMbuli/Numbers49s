<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>49s Lucky Pick</title>
  <meta name="theme-color" content="#ffcc00" />
  <link rel="manifest" href="manifest.json" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 1rem;
      background: #111;
      color: #eee;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    h1 {
      color: #ffcc00;
      margin-bottom: 0.5rem;
    }
    .number-set {
      font-size: 1.2rem;
      margin: 0.5rem 0;
      padding: 0.5rem;
      background: #222;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .top-pick {
      background: #333;
      font-size: 1.5rem;
      border: 2px solid #ffcc00;
      margin-bottom: 1rem;
      font-weight: bold;
    }
    .bonus {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: #00ffff;
      color: #111;
      font-weight: bold;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      margin-left: 1rem;
      font-size: 1.1rem;
      user-select: none;
      box-shadow: 0 0 6px #00ffffaa;
    }
    button {
      background: #ffcc00;
      border: none;
      padding: 0.8rem 2rem;
      font-size: 1.1rem;
      border-radius: 6px;
      cursor: pointer;
      color: #222;
      user-select: none;
      margin: 0.5rem;
    }
    button:hover {
      background: #e6b800;
    }
    .disabled {
      opacity: 0.5;
      pointer-events: none;
    }
    #cooldownTimer {
      margin-top: 2rem;
      font-size: 1.2rem;
      color: #ffcc00;
      font-weight: bold;
      user-select: none;
    }
    footer {
      margin-top: auto;
      font-size: 0.8rem;
      color: #666;
      padding: 1rem 0 0;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>49s Lucky Pick</h1>

  <div id="numbers"></div>
  <div id="timer"></div>

  <!-- Start Trial Button -->
  <button id="startTrialBtn">Start Free 48-Hour Trial</button>

  <button id="generateBtn" style="display:none;">Generate 5 Sequences</button>
  <button id="membershipBtn" style="display: none;">Join Full Membership (R10/month)</button>
  <a href="history.html"><button>üìú View History</button></a>

  <!-- Trial Notice -->
  <p id="trialNotice" style="
    margin-top: 1rem;
    font-size: 1.1rem;
    color: #00ffff;
    font-weight: bold;
    text-align: center;
    user-select: none;
    display: none;
  ">
    üéÅ You are on a 48-hour Free Trial! Enjoy limited-time full access.
  </p>

  <!-- Membership promo -->
  <p id="membershipPromo" style="
    display: none;
    margin-top: 1rem;
    font-size: 1.1rem;
    color: #ffcc00;
    font-weight: bold;
    text-align: center;
    user-select: none;
  ">
    üéØ Want more picks, anytime? Go full member for just R10/month!
  </p>

  <!-- Trust Message -->
  <div style="margin-top: 2rem; max-width: 600px; margin-left: auto; margin-right: auto; text-align: left; color: #ffffff; font-size: 1rem; line-height: 1.6;">
    <div id="trustPreview">
      Why Trust This Method?<br>
      Our system uses a finely tuned randomization engine built around UK 49s draw patterns.<br>
      Each number is uniquely generated with built-in probability logic.
    </div>
    <div id="trustFull" style="display: none;">
      <br>Tested. Balanced. Strategic.<br>
      Every 6-number set + bonus is precision-crafted for fairness, randomness, and consistency ‚Äî giving you confidence with every pick.<br><br>
      Combine it with your own intuition or stick to our top pick ‚Äî the odds are always fair, the method never sleeps.
    </div>
    <button onclick="toggleTrust()" style="margin-top: 0.5rem; background: none; border: none; color: #00ffff; font-size: 0.95rem; cursor: pointer;">
      Read More
    </button>
  </div>

  <div id="cooldownTimer"></div>

  <footer>¬© 2025 49s Lucky Pick ‚Äî Offline | 6x Picks | Bonus Number</footer>

  <script>
    const numbersDiv = document.getElementById('numbers');
    const generateBtn = document.getElementById('generateBtn');
    const membershipBtn = document.getElementById('membershipBtn');
    const timerDiv = document.getElementById('timer');
    const cooldownTimer = document.getElementById('cooldownTimer');
    const startTrialBtn = document.getElementById('startTrialBtn');
    const trialNotice = document.getElementById('trialNotice');
    const membershipPromo = document.getElementById('membershipPromo');
    const TEN_HOURS = 10 * 60 * 60 * 1000;

    // Cookie helpers
    function setCookie(name, value, days) {
      const expires = new Date(Date.now() + days*24*60*60*1000).toUTCString();
      document.cookie = name + "=" + encodeURIComponent(value) + "; expires=" + expires + "; path=/";
    }

    function getCookie(name) {
      const cookies = document.cookie.split('; ');
      for (let c of cookies) {
        const [key, val] = c.split('=');
        if (key === name) return decodeURIComponent(val);
      }
      return null;
    }

    function generateSet() {
      let main = new Set();
      while (main.size < 6) main.add(Math.floor(Math.random() * 49) + 1);
      let bonus;
      do {
        bonus = Math.floor(Math.random() * 49) + 1;
      } while (main.has(bonus));
      return { main: Array.from(main).sort((a,b) => a-b), bonus };
    }

    function generateAllSets() {
      let all = [];
      for (let i = 0; i < 5; i++) all.push(generateSet());
      return all;
    }

    function displaySets(sets) {
      numbersDiv.innerHTML = "";

      const first = sets[0];
      const topSet = document.createElement('div');
      topSet.className = 'number-set top-pick';
      topSet.innerHTML = `Top Pick: ${first.main.map(n => n.toString().padStart(2,'0')).join(' ')} <span class="bonus">${first.bonus.toString().padStart(2,'0')}</span>`;
      numbersDiv.appendChild(topSet);

      for (let i = 1; i < sets.length; i++) {
        const set = sets[i];
        const div = document.createElement('div');
        div.className = 'number-set';
        div.innerHTML = `Set ${i + 1}: ${set.main.map(n => n.toString().padStart(2,'0')).join(' ')} <span class="bonus">${set.bonus.toString().padStart(2,'0')}</span>`;
        numbersDiv.appendChild(div);
      }
    }

    function addToHistory(sets) {
      const date = new Date().toLocaleString();
      const entry = `(${date}) ` + sets
        .map(s => s.main.map(n => n.toString().padStart(2, '0')).join(' ') + ` [${s.bonus.toString().padStart(2, '0')}]`)
        .join(' | ');
      let history = JSON.parse(localStorage.getItem('history') || '[]');
      history.unshift(entry);
      if (history.length > 10) history = history.slice(0, 10);
      localStorage.setItem('history', JSON.stringify(history));
    }

    function updateStatus() {
      const isMember = getCookie('isMember') === 'true';
      const lastGen = parseInt(localStorage.getItem('lastGenerated') || '0');
      const now = Date.now();

      if (isMember) {
        generateBtn.classList.remove('disabled');
        timerDiv.textContent = "Full Member Access: Unlimited sets.";
        cooldownTimer.textContent = "";
      } else {
        const remaining = TEN_HOURS - (now - lastGen);
        if (remaining > 0) {
          generateBtn.classList.add('disabled');
          const hrs = Math.floor(remaining / (1000 * 60 * 60));
          const mins = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
          const secs = Math.floor((remaining % (1000 * 60)) / 1000);
          timerDiv.textContent = `Next free batch in: ${hrs}h ${mins}m ${secs}s`;
          cooldownTimer.textContent = `‚è≥ Please wait ${hrs}h ${mins}m ${secs}s before generating new numbers.`;
          setTimeout(updateStatus, 1000);
        } else {
          generateBtn.classList.remove('disabled');
          timerDiv.textContent = "Free Batch Available!";
          cooldownTimer.textContent = "";
        }
      }
    }

    // Trial & Membership with Cookies
    const trialCookie = 'freeTrialStart';
    const trialDuration = 48 * 60 * 60 * 1000; // 48 hours in ms

    function checkTrialStatus() {
      const now = Date.now();
      let start = getCookie(trialCookie);
      const isMember = getCookie('isMember') === 'true';

      if (isMember) {
        // Member - show membership notice, hide trial and membership btn
        startTrialBtn.style.display = 'none';
        membershipBtn.style.display = 'none';
        generateBtn.style.display = 'inline-block';
        trialNotice.textContent = "‚úÖ You are a Full Member. Enjoy unlimited access.";
        trialNotice.style.display = 'block';
        membershipPromo.style.display = 'none';
      } else if (start) {
        // Trial started
        const elapsed = now - parseInt(start);
        if (elapsed < trialDuration) {
          // Still in trial
          startTrialBtn.style.display = 'none';
          membershipBtn.style.display = 'none';
          generateBtn.style.display = 'inline-block';
          trialNotice.style.display = 'block';
          membershipPromo.style.display = 'none';
        } else {
          // Trial expired
          startTrialBtn.style.display = 'none';
          membershipBtn.style.display = 'inline-block';
          generateBtn.style.display = 'inline-block';
          trialNotice.style.display = 'none';
          membershipPromo.style.display = 'block';
        }
      } else {
        // No trial started yet - show only startTrialBtn, hide everything else
        startTrialBtn.style.display = 'inline-block';
        membershipBtn.style.display = 'none';
        generateBtn.style.display = 'none';
        trialNotice.style.display = 'none';
        membershipPromo.style.display = 'none';
      }
    }

    startTrialBtn.addEventListener('click', () => {
      // Start the free trial cookie
      const now = Date.now();
      setCookie(trialCookie, now, 2); // 2 days
      alert("üéâ Free Trial Started! You now have 48 hours of full access.");
      checkTrialStatus();
      updateStatus();
    });

    generateBtn.addEventListener('click', () => {
      if (generateBtn.classList.contains('disabled')) return;
      const sets = generateAllSets();
      displaySets(sets);
      addToHistory(sets);
      if (getCookie('isMember') !== 'true') {
        localStorage.setItem('lastGenerated', Date.now().toString());
      }
      updateStatus();
    });

    membershipBtn.addEventListener('click', () => {
      const confirmJoin = confirm("Join Full Membership for R10/month?\n(This is just a simulation in offline mode)");
      if (confirmJoin) {
        setCookie('isMember', 'true', 30); // Member for 30 days
        alert("You are now a Full Member! Unlimited sets unlocked.");
        checkTrialStatus();
        updateStatus();
      }
    });

    function toggleTrust() {
      const full = document.getElementById('trustFull');
      const btn = event.target;
      if (full.style.display === 'none') {
        full.style.display = 'block';
        btn.textContent = 'Show Less';
      } else {
        full.style.display = 'none';
        btn.textContent = 'Read More';
      }
    }

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js');
      });
    }

    checkTrialStatus();
    updateStatus();
  </script>
</body>
</html>
